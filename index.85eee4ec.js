var e;let t,a,r,l,n,i,s;const o=(e,t)=>{Array.isArray(e)?e.some(e=>o(e,t)):null!=e&&!1!==e&&t.append(e)},c=new Set(["ns","children","ref"]),u=new Map([["style",(e,t,a)=>{if("string"==typeof t)e.setAttribute(a,t);else for(a in t)a.startsWith("--")?e.style.setProperty(a,t[a]):e.style[a]=t[a]}]]),m=new Set(["value"]),d=(e,t)=>{let a,r,l=t.ns?document.createElementNS(t.ns,e):document.createElement(e);for(a in t)!c.has(a)&&(r=t[a],u.has(a)?u.get(a)(l,r,a):m.has(a)||a.startsWith("on")?l[a]=r:null!=r&&("boolean"!=typeof r||"-"===a[4])?l.setAttribute(a,r):r&&l.setAttribute(a,""));return o(t.children,"template"===e?l.content:l),(a=t.ref)&&("function"==typeof a?a(l):a.current=l),l},p=e=>Object.seal({current:e}),y=e=>{let t=new Text(e);return[t,a=>{e!==a&&(t.textContent=e=a)}]},{readyStore:h,dispatch:f,connect:b,getState:g}=(e=[e=>{let t=new URL(location.href);e.on("@init",()=>({url:localStorage.getItem("audio-player-url")??"",max:~~Number(localStorage.getItem("audio-player-max")),time:~~Number(t.searchParams.get("time")??localStorage.getItem("audio-player-time"))})),e.on("set/url",({url:e},t)=>{if(e!==t)return localStorage.setItem("audio-player-url",t),localStorage.removeItem("audio-player-time"),localStorage.removeItem("audio-player-max"),{url:t,max:0,time:0}}),e.on("set/time",({time:e},t)=>{if(e!==t)return localStorage.setItem("audio-player-time",""+t),history.replaceState("","","?time="+t),{time:t}}),e.on("set/max",({max:e},t)=>{if(e!==t)return localStorage.setItem("audio-player-max",""+t),{max:t}})}],t={},a={},r=[],l=(e,r)=>{if("@dispatch"!==e&&l("@dispatch",[e,r]),t[e]){let n;t[e].forEach(e=>{let t=e(a,r);t&&"function"!=typeof t.then&&(a={...a,...t},n={...n,...t})}),n&&l("@changed",n)}},n=(e,a)=>((t[e]??=[]).push(a),()=>{t[e]=t[e].filter(e=>e!==a)}),i=()=>a,s=e=>l("@set",e),n("@set",(e,t)=>t),e.forEach(e=>{e&&e({dispatch:l,on:n,get:i,set:s})}),l("@init"),{dispatch:l,getState:i,setState:s,connect(...e){let t=e.pop();return r.push({keys:e,cb:t}),()=>{r=r.filter(e=>e.cb!==t)}},readyStore:()=>(l("@ready"),n("@changed",(e,t)=>{r.forEach(e=>{e.keys.some(e=>e in t)&&e.cb(a)})}),Promise.all(r.map(e=>e.cb(a))))}),x=e=>(e<10?"0":"")+e,v=e=>`${x(~~(e/3600))}:${x(~~(e%3600/60))}:${x(e%60)}`;document.body.append(d("main",{ref:h,class:"_6Wd0w",children:[d("h1",{class:"_TW-iW",children:"Audio Player"}),(()=>{let e=p();return b("url",t=>{e.current.value=t.url}),d("div",{class:"_7vM1s",children:[d("label",{class:"_KbgC5","aria-label":"audio source",children:d("input",{ref:e,type:"url",class:"_Pa4ru",autocomplete:"url"})}),d("button",{type:"button",class:"_d0Tje",onclick:()=>f("set/url",e.current.value.trim()),"aria-label":"add",children:"+"})]})})({}),(()=>{let e=g(),[t,a]=y(v(e.max)),[r,l]=y(v(e.time));return d("div",{class:"_jljmn",children:[d("strong",{children:t})," / ",r,d("progress",{ref:e=>{b("max",t=>{e.max=t.max,a(v(t.max))}),b("time",t=>{e.value=t.time,l(v(t.time))})},class:"_urNbd",max:e.max,value:e.time})]})})({}),(()=>{let[e,t]=y("Play");return d("button",{ref:e=>{let a;let r=new Audio,l=()=>f("set/time",~~r.currentTime);e.addEventListener("click",()=>{r.paused?r.play():r.pause()}),r.addEventListener("play",()=>{a=setInterval(l,1e3),t("Pause")}),r.addEventListener("pause",()=>{clearInterval(a),l(),t("Play")}),r.addEventListener("canplay",()=>{e.disabled=!1,t("Play"),f("set/max",~~r.duration)}),b("url",t=>{e.disabled=!0,r.src=t.url,r.currentTime=t.time})},class:"_yt09E",type:"button",disabled:"",children:e})})({})]}));